<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Main simulation function for serosim — runserosim • serosim</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Main simulation function for serosim — runserosim"><meta property="og:description" content="Simulates a serological survey using user-specified inputs and models."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">serosim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/case_study_1_measles.html">Case study 1: a one pathogen system with vaccination (measles)</a>
    </li>
    <li>
      <a href="../articles/case_study_2_diphtheria_pertussis.html">Case study 2: a multi-pathogen system with multivalent vaccinaton (diphtheria and pertussis)</a>
    </li>
    <li>
      <a href="../articles/case_study_3_influenza.html">Case study 3: a multi-strain pathogen system with cross-reactive antibody dynamics</a>
    </li>
    <li>
      <a href="../articles/case_study_4_inference.html">Case study 4: Using serosim to assess the performance of seroepidemiological inference methods</a>
    </li>
    <li>
      <a href="../articles/quickstart.html">quickstart: Extended version of the README simulation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AMenezes97/serosim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Main simulation function for <em>serosim</em></h1>
    <small class="dont-index">Source: <a href="https://github.com/AMenezes97/serosim/blob/HEAD/R/runserosim.R" class="external-link"><code>R/runserosim.R</code></a></small>
    <div class="hidden name"><code>runserosim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates a serological survey using user-specified inputs and models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">runserosim</span><span class="op">(</span></span>
<span>  <span class="va">simulation_settings</span>,</span>
<span>  demography <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  observation_times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">foe_pars</span>,</span>
<span>  <span class="va">biomarker_map</span>,</span>
<span>  <span class="va">model_pars</span>,</span>
<span>  <span class="va">exposure_model</span>,</span>
<span>  <span class="va">immunity_model</span>,</span>
<span>  <span class="va">antibody_model</span>,</span>
<span>  <span class="va">observation_model</span>,</span>
<span>  <span class="va">draw_parameters</span>,</span>
<span>  immune_histories_fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  VERBOSE <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  attempt_precomputation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  parallel_packages <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>simulation_settings</dt>
<dd><p>A list of parameters governing the simulation time step settings. Should contain integer entries for <em>t_start</em> and <em>t_end</em></p></dd>


<dt>demography</dt>
<dd><p>A tibble of demographic information for each individual in the simulation. At a minimum this tibble requires 1 column (i) where all individuals in the simulation are listed by row. This is used to calculate the sample population size. Additional variables can be added by the user, e.g., birth and removal times, see <code><a href="generate_pop_demography.html">generate_pop_demography</a></code> If not specified, the model will assume that birth time is the initial time point and removal time is the final time point across all individuals</p></dd>


<dt>observation_times</dt>
<dd><p>A tibble for observation times with three variables: 1) i: individual; 2) t: the timepoint of an observation; 3) b: the biomarker being measured. Defaults to NULL, in which case all latent biomarker states are returned</p></dd>


<dt>foe_pars</dt>
<dd><p>Any object class (usually a 3D array, but may be a list or other object) providing the force of exposure for each exposure ID, group and time, or parameters of the model generating the FOEs</p></dd>


<dt>biomarker_map</dt>
<dd><p>A tibble specifying the relationship between exposure IDs and biomarker IDs with two variables: 1) exposure_id: the numeric exposure ID; 2) biomarker_id: the numeric biomarker ID</p></dd>


<dt>model_pars</dt>
<dd><p>A tibble of parameters needed for the antibody kinetics model, immunity model, observation model and the draw_parameters function</p></dd>


<dt>exposure_model</dt>
<dd><p>A function calculating the probability of exposure given the foe_pars array</p></dd>


<dt>immunity_model</dt>
<dd><p>A function determining the probability of an exposure leading to successful infection or vaccination for a given individual</p></dd>


<dt>antibody_model</dt>
<dd><p>A function determining the latent biomarker kinetics as a function of immune history and within-host kinetics parameters (<code>model_pars</code>)</p></dd>


<dt>observation_model</dt>
<dd><p>A function generating observed biomarkers as a function of latent biomarkers and observation model parameters (<code>model_pars</code>)</p></dd>


<dt>draw_parameters</dt>
<dd><p>A function to simulate parameters for the antibody model, immunity model and observation model from <code>model_pars</code></p></dd>


<dt>immune_histories_fixed</dt>
<dd><p>(optional) Defaults to NULL. Otherwise a 3D array indicating the immune history (1 = exposed, 0 = not exposed) for each individual (dimension 1) at each time (dimension 2) for each exposure ID (dimension 3). Here, users can input pre-specified information if immune histories are known for an individual</p></dd>


<dt>VERBOSE</dt>
<dd><p>(optional) Defaults to NULL. An integer specifying the frequency at which simulation progress updates are printed</p></dd>


<dt>attempt_precomputation</dt>
<dd><p>If TRUE, attempts to perform as much pre-computation as possible for the exposure model to speed up the main simulation code. If FALSE, skips this step, which is advised when the simulation is expected to be very fast anyway</p></dd>


<dt>parallel</dt>
<dd><p>If TRUE, attempts to run <em>serosim</em> using parallel processes with the foreach and parallel packages. Defaults to FALSE</p></dd>


<dt>n_cores</dt>
<dd><p>The number of cores to use if running in parallel. Defaults to 4</p></dd>


<dt>parallel_packages</dt>
<dd><p>a character vector of R packages required for the models. Only needed if additional non-imported packages are required.</p></dd>


<dt>...</dt>
<dd><p>Any additional arguments needed for the models</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a list containing the following elements: force of exposure, exposure probabilities, immune histories, antibody states, observed antibody states, and kinetics parameters</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>runserosim</code> function is designed as a plug-and-play multi-level model representing the different stages of the data-generating process for serological data. The user can specify inputs controlling population demography, simulation time period, observation times for each individual, force of exposure, and various model functions describing the link between infections and observed biomarker quantities. See README for full details of the workflow.</p>
<p>There are two optional flags to attempt speed ups with serosim: <code>attempt_precomputation</code> and <code>parallel</code>. <code>attempt_precomputation</code> will check how many interchangeable individuals there are and pre-compute exposure probabilities for these individuals if that would be quicker than solving for each individual separately. <code>parallel</code> uses the <code>foreach</code> package with <code>dopar</code> to run <em>serosim</em> for blocks of individuals on a socket cluster. The number of cores is set with the <code>n_cores</code> argument. If any additional packages are needed for the model, then the <code>parallel_packages</code> argument should be set.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## See package README.</span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arthur Menezes, James Hay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

