<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Serosurvey simulation • serosim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Serosurvey simulation">
<meta property="og:description" content="serosim is an open source R package designed to aid inference
    from serological surveys, by simulating data arising from
    user-specified vaccine and infection-generated antibody kinetics
    processes using a random effects model. serosim allows users to
    specify and adjust model inputs representing underlying processes
    responsible for generating the observed titer values like time-varying
    patterns of infection and vaccination, population demography, immunity
    and antibody kinetics, and serological survey sampling design in order
    to best represent the population and disease system(s) of interest.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">serosim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/case_study_1_measles.html">Case study 1: a one pathogen system with vaccination (measles)</a>
    </li>
    <li>
      <a href="articles/case_study_2_diphtheria_pertussis.html">Case study 2: a multi-pathogen system with multivalent vaccinaton (diphtheria and pertussis)</a>
    </li>
    <li>
      <a href="articles/case_study_3_influenza.html">Case study 3: a multi-strain pathogen system with cross-reactive antibody dynamics</a>
    </li>
    <li>
      <a href="articles/case_study_4_inference.html">Case study 4: Using serosim to assess the performance of seroepidemiological inference methods</a>
    </li>
    <li>
      <a href="articles/quickstart.html">quickstart: Extended version of the README simulation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/seroanalytics/serosim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="serosim">serosim<a class="anchor" aria-label="anchor" href="#serosim"></a>
</h1></div>
<p><img src="reference/figures/logo.png" align="right" height="100"></p>
<!-- badges: start -->

</div>
<div class="section level1">
<h1 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h1>
<p>The <em>serosim</em> package is designed to simulate serological data arising from user-specified vaccine or infection-generated and antibody kinetics processes. <em>serosim</em> allows users to specify and adjust model inputs responsible for generating the observed biomarker quantities like time-varying patterns of infection and vaccination, population demography, immunity and antibody kinetics, and serological survey sampling design in order to best represent the population and disease system(s) of interest.</p>
<p>Here, we will use the <em>serosim</em> package to generate a simple cross-sectional serosurvey at the end of a 10 year simulation period for 100 individuals who have either been vaccinated, infected, both or neither. We will set up each of the required arguments and models for the <em>runserosim</em> function in the order outlined in the methods section of the paper. We then run the simulation and examine its outputs.</p>
<p>In the <em>vignettes</em> folder, you can find a more detailed walk through of this simple README simulation titled <em>quickstart.Rmd</em>.</p>
<p>There are three additional complex vignettes/case studies in the <em>vignettes</em> folder.</p>
<p>Case study 1 provides an example of a longitudinal singular biomarker serological data simulation structured around measles, a one-pathogen system with vaccination, but also applicable to other vaccine preventable diseases.</p>
<p>Case study 2 provides an example of a cross-sectional multi-biomarker serological data structured around diphtheria and pertussis, a two-pathogen system with bivalent vaccination, but also applicable to multi-pathogen systems with multivalent vaccines.</p>
<p>Case study 3 provides an example of a cross-sectional serosurvey of a one pathogen system with cross-reactive strains, modeled after influenza. This example tracks 3 circulating strains and strain specific biomarkers produced after infection.</p>
<p>Case study 4 demonstrates how serological data simulated from a complex, realistic serosim model can be used to assess the accuracy of various seroepidemiological inference methods.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>Load necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Install and load serosim </span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"seroanalytics/serosim"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── R CMD build ─────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;      checking for file ‘/private/var/folders/33/9_2zcl8d6nl5jjdl97fpmr080000gn/T/RtmpOtZbO8/remotes231339f3cb87/seroanalytics-serosim-ee073f8/DESCRIPTION’ ...  ✔  checking for file ‘/private/var/folders/33/9_2zcl8d6nl5jjdl97fpmr080000gn/T/RtmpOtZbO8/remotes231339f3cb87/seroanalytics-serosim-ee073f8/DESCRIPTION’</span></span>
<span><span class="co">#&gt;   ─  preparing ‘serosim’:</span></span>
<span><span class="co">#&gt;      checking DESCRIPTION meta-information ...  ✔  checking DESCRIPTION meta-information</span></span>
<span><span class="co">#&gt;   ─  cleaning src</span></span>
<span><span class="co">#&gt;   ─  checking for LF line-endings in source and make files and shell scripts</span></span>
<span><span class="co">#&gt;   ─  checking for empty or unneeded directories</span></span>
<span><span class="co">#&gt;   ─  building ‘serosim_0.0.0.9000.tar.gz’</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/seroanalytics/serosim" class="external-link">serosim</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Load additional packages required </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_11-simulation-settings">1.1 Simulation Settings<a class="anchor" aria-label="anchor" href="#id_11-simulation-settings"></a>
</h1>
<p>We will simulate monthly time steps across a 10 year period.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify the number of time steps in the simulation</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">120</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_12-population-demography">1.2 Population Demography<a class="anchor" aria-label="anchor" href="#id_12-population-demography"></a>
</h1>
<p>For this case study, we will be simulating a population with 100 individuals and we are not interested in tracking any demography information other than an individual’s birth time.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate the population demography tibble</span></span>
<span><span class="va">demography</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/generate_pop_demography.html">generate_pop_demography</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">100</span>, times<span class="op">=</span><span class="va">times</span>, prob_removal<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(i)`</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_13-exposure-to-biomarker-mapping">1.3 Exposure to biomarker mapping<a class="anchor" aria-label="anchor" href="#id_13-exposure-to-biomarker-mapping"></a>
</h1>
<p>Now we set up the exposure IDs and biomarker IDs for the simulation which will determine which infection or vaccination events are occurring. Here, we will simulate one circulating pathogen (exposure_ID=ifxn) and one vaccine (exposure_ID=vacc) both of which will boost the same biomarker, IgG titers (biomarker_ID=IgG).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create biomarker map</span></span>
<span><span class="va">biomarker_map_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>exposure_id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ifxn"</span>,<span class="st">"vacc"</span><span class="op">)</span>,biomarker_id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IgG"</span>,<span class="st">"IgG"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Reformat biomarker_map for runserosim</span></span>
<span><span class="va">biomarker_map</span> <span class="op">&lt;-</span><span class="fu"><a href="reference/reformat_biomarker_map.html">reformat_biomarker_map</a></span><span class="op">(</span><span class="va">biomarker_map_original</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_14-force-of-exposure-and-exposure-model">1.4 Force of Exposure and Exposure Model<a class="anchor" aria-label="anchor" href="#id_14-force-of-exposure-and-exposure-model"></a>
</h1>
<p>Now, we need to specify the foe_pars argument which contains the force of exposure for all exposure_IDs across all time steps. The exposure model, specified within the <em>runserosim</em> function in section 1.9, will determine the probability that an individual is exposed to a specific exposure event.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create an empty array to store the force of exposure for all exposure types</span></span>
<span><span class="va">foe_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,<span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">biomarker_map</span><span class="op">$</span><span class="va">exposure_id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Specify the force of exposure for exposure ID 1 which represents natural infection</span></span>
<span><span class="va">foe_pars</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="co">## Specify the force of exposure for exposure ID 2 which represents vaccination</span></span>
<span><span class="va">foe_pars</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_15-immunity-model">1.5 Immunity Model<a class="anchor" aria-label="anchor" href="#id_15-immunity-model"></a>
</h1>
<p>Here, we specify the immunity model which will determine the probability that an exposure event is successful in producing an immunological response. We will use a simple immunity model (immunity_model_vacc_ifxn_simple) where successful exposure is only conditional on the total number of previous exposure events. With this model, the probability of successful vaccination exposure depends on the number of vaccines received prior to time t and the individual’s age at time t while the probability of successful infection is dependent on the number of infections prior to time t.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## All models and arguments for this section are directly specified within the runserosim function belwo in section 1.9</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_16-antibody-model-and-model-parameters">1.6 Antibody Model and Model Parameters<a class="anchor" aria-label="anchor" href="#id_16-antibody-model-and-model-parameters"></a>
</h1>
<p>Now, we specify the antibody model to be used within <em>runserosim</em> to track antibody kinetics, or more broadly biomarker kinetics for each biomarker produced from successful exposure events. The antibody kinetics parameters are pre-loaded within a csv file. Users can edit the csv file to specify their own parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Bring in the antibody parameters needed for the antibody model</span></span>
<span><span class="co">## Note that the observation error parameter needed for the observation model (Section 1.7) is defined here too.</span></span>
<span><span class="va">model_pars_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"model_pars_README.csv"</span>, package <span class="op">=</span> <span class="st">"serosim"</span><span class="op">)</span></span>
<span><span class="va">model_pars_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">model_pars_path</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Reformat model_pars for runserosim so that exposure_id and biomarker_id are numeric and match the exposure to biomarker map</span></span>
<span><span class="va">model_pars</span><span class="op">&lt;-</span><span class="fu"><a href="reference/reformat_biomarker_map.html">reformat_biomarker_map</a></span><span class="op">(</span><span class="va">model_pars_original</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_17-observation-model-and-observation_times">1.7 Observation Model and observation_times<a class="anchor" aria-label="anchor" href="#id_17-observation-model-and-observation_times"></a>
</h1>
<p>In this step, we specify the sampling design and assay choice for our serological survey. We will take samples of all individuals at the end of the simulation (t=120).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## All models and arguments for this section are directly specified within the runserosim function belwo in section 1.9</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_18-optional-arguments">1.8 Optional Arguments<a class="anchor" aria-label="anchor" href="#id_18-optional-arguments"></a>
</h1>
<p>There are no optional arguments needed for this simulation.</p>
</div>
<div class="section level1">
<h1 id="id_19-run-simulation">1.9 Run Simulation<a class="anchor" aria-label="anchor" href="#id_19-run-simulation"></a>
</h1>
<p>This is the core simulation where all simulation settings, models and parameters are specified within the main simulation function. Run time for this step varies depending on the number of individuals and the complexities of the specified models. There is a built in pre-computation step within <em>runserosim</em> where the simulation attempts to perform as much pre-computation as possible for the exposure model to speed up the main simulation code. Users can turn off this pre-computation by setting pre-computation to FALSE within <em>runserosim</em>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Run the core simulation and save outputs in "res"</span></span>
<span><span class="va">res</span><span class="op">&lt;-</span> <span class="fu"><a href="reference/runserosim.html">runserosim</a></span><span class="op">(</span></span>
<span>  simulation_settings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"t_start"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"t_end"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">demography</span>,</span>
<span>  observation_times<span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>i<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">demography</span><span class="op">$</span><span class="va">i</span><span class="op">)</span>,t<span class="op">=</span><span class="fl">120</span>, b<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">foe_pars</span>,</span>
<span>  <span class="va">biomarker_map</span>,</span>
<span>  <span class="va">model_pars</span>,</span>
<span>  exposure_model<span class="op">=</span><span class="va">exposure_model_simple_FOE</span>,</span>
<span>  immunity_model<span class="op">=</span><span class="va">immunity_model_vacc_ifxn_simple</span>,</span>
<span>  antibody_model<span class="op">=</span><span class="va">antibody_model_monophasic</span>,</span>
<span>  observation_model<span class="op">=</span><span class="va">observation_model_continuous_noise</span>,</span>
<span>  draw_parameters<span class="op">=</span><span class="va">draw_parameters_random_fx</span>,</span>
<span></span>
<span>  <span class="co">## Other arguments needed</span></span>
<span>  max_events<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  vacc_exposures<span class="op">=</span><span class="fl">2</span>,</span>
<span>  vacc_age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">9</span><span class="op">)</span>,</span>
<span>  sensitivity<span class="op">=</span><span class="fl">0.85</span>,</span>
<span>  specificity<span class="op">=</span><span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_110-generate-plots">1.10 Generate Plots<a class="anchor" aria-label="anchor" href="#id_110-generate-plots"></a>
</h1>
<p>Now that the simulation is complete, let’s plot and examine some of the simulation outputs.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot biomarker kinetics and immune histories for 10 individuals </span></span>
<span><span class="fu"><a href="reference/plot_subset_individuals_history.html">plot_subset_individuals_history</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">biomarker_states</span>, <span class="va">res</span><span class="op">$</span><span class="va">immune_histories_long</span>, subset<span class="op">=</span><span class="fl">10</span>, <span class="va">demography</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 31 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-11-1.png"><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Plot the serosurvey results (observed biomarker quantities)</span></span>
<span><span class="fu"><a href="reference/plot_obs_biomarkers_one_sample.html">plot_obs_biomarkers_one_sample</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">observed_biomarker_states</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-11-2.png"><!-- --></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/seroanalytics/serosim/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/seroanalytics/serosim/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing serosim</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Arthur Menezes <br><small class="roles"> Author, maintainer </small>  </li>
<li>James Hay <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/seroanalytics/serosim/actions/workflows/check-standard.yaml" class="external-link"><img src="https://github.com/seroanalytics/serosim/actions/workflows/check-standard.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.codefactor.io/repository/github/seroanalytics/serosim" class="external-link"><img src="https://www.codefactor.io/repository/github/seroanalytics/serosim/badge" alt="CodeFactor"></a></li>
<li><a href="https://github.com/seroanalytics/serosim/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/seroanalytics/serosim/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Arthur Menezes, James Hay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
